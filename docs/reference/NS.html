<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Normal scale (NS) bandwidth selector — NS • sparr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Normal scale (NS) bandwidth selector — NS" />
<meta property="og:description" content="Provides the asymptotically optimal fixed bandwidths for spatial or spatiotemporal 
normal densities based on a simple expression." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2-15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fmd_animation/fmd_animation.html">Foot and Mouth disease animation</a>
    </li>
    <li>
      <a href="../articles/fmd_interactive/fmd_interactive.html">Foot and mouth disease interactive</a>
    </li>
    <li>
      <a href="../articles/pbc_interactive/pbc_interactive.html">Primary biliary cirrhosis interactive</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tilmandavies/sparr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Normal scale (NS) bandwidth selector</h1>
    <small class="dont-index">Source: <a href='https://github.com/tilmandavies/sparr/blob/master/R/NS.R'><code>R/NS.R</code></a>, <a href='https://github.com/tilmandavies/sparr/blob/master/R/NS.spattemp.R'><code>R/NS.spattemp.R</code></a></small>
    <div class="hidden name"><code>NS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides the asymptotically optimal fixed bandwidths for spatial or spatiotemporal 
normal densities based on a simple expression.</p>
    </div>

    <pre class="usage"><span class='fu'>NS</span><span class='op'>(</span>
  <span class='va'>pp</span>,
  nstar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"npoints"</span>, <span class='st'>"geometric"</span><span class='op'>)</span>,
  scaler <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"silverman"</span>, <span class='st'>"IQR"</span>, <span class='st'>"sd"</span>, <span class='st'>"var"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>NS.spattemp</span><span class='op'>(</span>
  <span class='va'>pp</span>,
  tt <span class='op'>=</span> <span class='cn'>NULL</span>,
  nstar <span class='op'>=</span> <span class='st'>"npoints"</span>,
  scaler <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"silverman"</span>, <span class='st'>"IQR"</span>, <span class='st'>"sd"</span>, <span class='st'>"var"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pp</th>
      <td><p>An object of class <code><a href='https://rdrr.io/pkg/spatstat.geom/man/ppp.html'>ppp</a></code> giving the observed
2D data to be smoothed.</p></td>
    </tr>
    <tr>
      <th>nstar</th>
      <td><p>Optional. Controls the value to use in place of the number of
observations <em>n</em> in the normal scale formula. Either a character
string, <code>"npoints"</code> (default) or <code>"geometric"</code> (only possible for <code>NS</code>), or a positive
numeric value. See `Details'.</p></td>
    </tr>
    <tr>
      <th>scaler</th>
      <td><p>Optional. Controls the value for a scalar representation of
the spatial (and temporal for <code>NS.spattemp</code>) scale of the data. Either a character string, <code>"silverman"</code>
(default), <code>"IQR"</code>, <code>"sd"</code>, or <code>"var"</code>; or a positive numeric
value. See `Details'.</p></td>
    </tr>
    <tr>
      <th>tt</th>
      <td><p>A numeric vector of equal length to the number of points in <code>pp</code>, 
giving the time corresponding to each spatial observation. If unsupplied, 
the function attempts to use the values in the <code><a href='https://rdrr.io/pkg/spatstat.geom/man/marks.html'>marks</a></code> 
attribute of the <code><a href='https://rdrr.io/pkg/spatstat.geom/man/ppp.html'>ppp.object</a></code> in <code>pp</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A single numeric value of the estimated spatial bandwidth for <code>NS</code>, or a named numeric vector of length 2 giving
the spatial bandwidth (as <code>h</code>) and the temporal bandwidth (as <code>lambda</code>) for <code>NS.spattemp</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions calculate scalar smoothing bandwidths for kernel density
estimates of spatial or spatiotemporal data: the optimal values would minimise the
asymptotic mean integrated squared error assuming normally distributed data; see pp. 46-48
of Silverman (1986). The <code>NS</code> function returns a single bandwidth for isotropic smoothing
of spatial (2D) data. The <code>NS.spattemp</code> function returns two values -- one for
the spatial margin and another for the temporal margin, based on independently applying
the normal scale rule (in 2D and 1D) to the spatial and temporal margins of the supplied data.</p>
<dl>
  <dt><b>Effective sample size</b></dt><dd><p>The formula
    requires a sample size, and this can be minimally tailored via <code>nstar</code>.
    By default, the function simply uses the number of observations in
    <code>pp</code>: <code>nstar = "npoints"</code>. Alternatively, the user can specify their own value by simply
    supplying a single positive numeric value to <code>nstar</code>. 
    For <code>NS</code> (not applicable to <code>NS.spattemp</code>), if <code>pp</code> is a
    <code><a href='https://rdrr.io/pkg/spatstat.geom/man/ppp.html'>ppp.object</a></code> with factor-valued
    <code><a href='https://rdrr.io/pkg/spatstat.geom/man/marks.html'>marks</a></code>, then the user has the option of using
    <code>nstar = "geometric"</code>, which sets the sample size used in the formula
    to the geometric mean of the counts of observations of each mark. This can
    be useful for e.g. relative risk calculations, see Davies and Hazelton
    (2010).</p></dd>
  <dt><b>Spatial (and temporal) scale</b></dt><dd><p>The <code>scaler</code> argument is used to specify spatial
  (as well as temporal, in use of <code>NS.spattemp</code>) scale. For isotropic smoothing in the spatial
  margin, one may use the `robust' estimate
    of standard deviation found by a weighted mean of the interquartile ranges
    of the \(x\)- and \(y\)-coordinates of the data respectively
    (<code>scaler = "IQR"</code>). Two other options are the raw mean of the
    coordinate-wise standard deviations (<code>scaler = "sd"</code>), or the square
    root of the mean of the two variances (<code>scaler = "var"</code>). A fourth
    option, <code>scaler = "silverman"</code> (default), sets the scaling constant to
    be the minimum of the <code>"IQR"</code> and <code>"sd"</code> options; see Silverman
    (1986), p. 47. In use of <code>NS.spattemp</code> the univariate version of the elected scale
    statistic is applied to the recorded times of the data for the temporal bandwidth.
    Alternatively, like <code>nstar</code>, the user can specify their
    own value by simply supplying a single positive numeric value to
    <code>scaler</code> for <code>NS</code>, or a numeric vector of length 2 (in the order of <em>[&lt;spatial scale&gt;, &lt;temporal scale&gt;]</em>)
    for <code>NS.spattemp</code>.</p></dd>

</dl>

    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>The NS bandwidth is an approximation, and assumes
<em>that the target density is normal</em>. This is considered rare
in most real-world applications. Nevertheless, it remains a quick and easy
`rule-of-thumb' method with which one may obtain a smoothing parameter. Note that a similar expression for the adaptive kernel
estimator is not possible (Davies et al., 2018).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Davies, T.M. and Hazelton, M.L. (2010), Adaptive kernel
estimation of spatial relative risk, <em>Statistics in Medicine</em>,
<b>29</b>(23) 2423-2437.</p>
<p>Davies, T.M., Flynn, C.R. and Hazelton, M.L.
(2018), On the utility of asymptotic bandwidth selectors for spatially
adaptive kernel density estimation, <em>Statistics &amp; Probability Letters</em> [in press].</p>
<p>Silverman, B.W. (1986), <em>Density Estimation for Statistics and Data Analysis</em>, Chapman
&amp; Hall, New York.</p>
<p>Wand, M.P. and Jones, C.M., 1995. <em>Kernel Smoothing</em>, Chapman &amp; Hall, London.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>T.M. Davies</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pbc</span><span class='op'>)</span>

<span class='fu'>NS</span><span class='op'>(</span><span class='va'>pbc</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 2.769906</div><div class='input'><span class='fu'>NS</span><span class='op'>(</span><span class='va'>pbc</span>,nstar<span class='op'>=</span><span class='st'>"geometric"</span><span class='op'>)</span> <span class='co'># uses case-control marks to replace sample size</span>
</div><div class='output co'>#&gt; [1] 3.225647</div><div class='input'><span class='fu'>NS</span><span class='op'>(</span><span class='va'>pbc</span>,scaler<span class='op'>=</span><span class='st'>"var"</span><span class='op'>)</span> <span class='co'># set different scalar measure of spread</span>
</div><div class='output co'>#&gt; [1] 4.562146</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>burk</span><span class='op'>)</span>
<span class='fu'>NS.spattemp</span><span class='op'>(</span><span class='va'>burk</span><span class='op'>$</span><span class='va'>cases</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         h    lambda 
#&gt;  10.36718 441.14599 </div><div class='input'><span class='fu'>NS.spattemp</span><span class='op'>(</span><span class='va'>burk</span><span class='op'>$</span><span class='va'>cases</span>,scaler<span class='op'>=</span><span class='st'>"sd"</span><span class='op'>)</span> 
</div><div class='output co'>#&gt;         h    lambda 
#&gt;  11.54816 441.14599 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tilman M. Davies, Jonathan C. Marshall.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


