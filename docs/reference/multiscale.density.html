<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multi-scale adaptive kernel density/intensity estimation — multiscale.density • sparr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-scale adaptive kernel density/intensity estimation — multiscale.density"><meta property="og:description" content="Computes adaptive kernel estimates of spatial density/intensity using a 3D
FFT for multiple global bandwidth scales."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/fmd_animation/fmd_animation.html">Foot and Mouth disease animation</a>
    </li>
    <li>
      <a href="../articles/fmd_interactive/fmd_interactive.html">Foot and mouth disease interactive</a>
    </li>
    <li>
      <a href="../articles/pbc_interactive/pbc_interactive.html">Primary biliary cirrhosis interactive</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tilmandavies/sparr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multi-scale adaptive kernel density/intensity estimation</h1>
    <small class="dont-index">Source: <a href="https://github.com/tilmandavies/sparr/blob/HEAD/R/multiscale.density.R" class="external-link"><code>R/multiscale.density.R</code></a></small>
    <div class="hidden name"><code>multiscale.density.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes adaptive kernel estimates of spatial density/intensity using a 3D
FFT for multiple global bandwidth scales.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multiscale.density</span><span class="op">(</span></span>
<span>  <span class="va">pp</span>,</span>
<span>  <span class="va">h0</span>,</span>
<span>  hp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  h0fac <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uniform"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">128</span>,</span>
<span>  dimz <span class="op">=</span> <span class="fl">64</span>,</span>
<span>  gamma.scale <span class="op">=</span> <span class="st">"geometric"</span>,</span>
<span>  trim <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  intensity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pilot.density <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  taper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pp</dt>
<dd><p>An object of class <code><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html" class="external-link">ppp</a></code> giving the observed
2D data set to be smoothed.</p></dd>


<dt>h0</dt>
<dd><p>Reference global bandwidth for adaptive smoothing; numeric value &gt;
0. Multiscale estimates will be computed by rescaling this value as per
<code>h0fac</code>.</p></dd>


<dt>hp</dt>
<dd><p>Pilot bandwidth (scalar, numeric &gt; 0) to be used for fixed
bandwidth estimation of the pilot density. If <code>NULL</code> (default), it will
take on the value of <code>h0</code>. Ignored when <code>pilot.density</code> is
supplied as a pre-defined pixel image.</p></dd>


<dt>h0fac</dt>
<dd><p>A numeric vector of length 2 stipulating the span of the global
bandwidths in the multiscale estimates. Interpreted as a multiplicative
factor on <code>h0</code>. See `Details'.</p></dd>


<dt>edge</dt>
<dd><p>Character string dictating edge correction. <code>"uniform"</code>
(default) corrects based on evaluation grid coordinate. Setting <code>edge="none"</code>
requests no edge correction.</p></dd>


<dt>resolution</dt>
<dd><p>Numeric value &gt; 0. Resolution of evaluation grid in the
spatial domain; the densities/intensities will be returned on a
[<code>resolution</code> \(\times\) <code>resolution</code>] grid.</p></dd>


<dt>dimz</dt>
<dd><p>Resolution of z- (rescaled bandwidth)-axis in the trivariate
convolution. Higher values increase precision of the multiscale estimates at
a computational cost. See `Details'.</p></dd>


<dt>gamma.scale</dt>
<dd><p>Scalar, numeric value &gt; 0; controls rescaling of the
variable bandwidths. Defaults to the geometric mean of the bandwidth factors
given the pilot density (as per Silverman, 1986). See the documentation for
<code><a href="bivariate.density.html">bivariate.density</a></code>.</p></dd>


<dt>trim</dt>
<dd><p>Numeric value &gt; 0; controls bandwidth truncation for adaptive
estimation. See the documentation for <code><a href="bivariate.density.html">bivariate.density</a></code>.</p></dd>


<dt>intensity</dt>
<dd><p>Logical value indicating whether to return an intensity
estimate (integrates to the sample size over the study region), or a density
estimate (default, integrates to 1).</p></dd>


<dt>pilot.density</dt>
<dd><p>An optional pixel image (class
<code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a></code>) giving the pilot density to be used for
calculation of the variable bandwidths in adaptive estimation, <b>or</b> a
<code><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html" class="external-link">ppp.object</a></code> giving the data upon which to base a
fixed-bandwidth pilot estimate using <code>hp</code>. See the documentation for
<code><a href="bivariate.density.html">bivariate.density</a></code>.</p></dd>


<dt>xy</dt>
<dd><p>Optional alternative specification of the spatial evaluation grid;
matches the argument of the same tag in <code><a href="https://rdrr.io/pkg/spatstat.geom/man/as.mask.html" class="external-link">as.mask</a></code>. If
supplied, <code>resolution</code> is ignored.</p></dd>


<dt>taper</dt>
<dd><p>Logical value indicating whether to taper off the trivariate
kernel outside the range of <code>h0*h0fac</code> in the scale space; see Davies &amp;
Baddeley (2018). Keep at the default <code>TRUE</code> if you don't know what this
means.</p></dd>


<dt>verbose</dt>
<dd><p>Logical value indicating whether to print function progress.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>"msden"</code>. This is very similar to a
<code><a href="bivariate.density.html">bivden</a></code> object, with lists of pixel
<code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a></code>ages in the <code>z</code>, <code>him</code>, and <code>q</code></p>


<p>components (instead of standalone images).</p>
<dl><dt>z</dt>
<dd><p>A list of the resulting
  density/intensity estimates; each member being a pixel image object of class
  <code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a></code>. They are placed in increasing order of the
  discretised values of <code>h0</code>.</p></dd>

<dt>h0</dt>
<dd><p>A copy of the reference value of <code>h0</code> used.</p></dd>

<dt>h0range</dt>
<dd><p>A vector of length 2 giving the actual range
  of global bandwidth values available (inclusive).</p></dd>

<dt>hp</dt>
<dd><p>A copy of the value of <code>hp</code> used.</p></dd>

<dt>h</dt>
<dd><p>A numeric vector of length equal to the
  number of data points, giving the bandwidth used for the corresponding
  observation in <code>pp</code> with respect to the reference global bandwidth
  <code>h0</code>.</p></dd>

<dt>him</dt>
<dd><p>A list of pixel images (class <code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a></code>),
  corresponding to <code>z</code>, giving the
  `hypothetical' Abramson bandwidth at each pixel coordinate conditional upon
  the observed data and the global bandwidth used.</p></dd>

<dt>q</dt>
<dd><p>Edge-correction weights; list of pixel <code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a></code>ages
  corresponding to <code>z</code> if <code>edge = "uniform"</code>, and <code>NULL</code> if
  <code>edge = "none"</code>.</p></dd>

<dt>gamma</dt>
<dd><p>The numeric value of <code>gamma.scale</code> used in scaling the bandwidths.</p></dd>

<dt>geometric</dt>
<dd><p>The geometric mean of the
  untrimmed variable bandwidth factors. This will be identical to <code>gamma</code>
  if <code>gamma.scale = "geometric"</code> as per default.</p></dd>

<dt>pp</dt>
<dd><p>A copy of the <code><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html" class="external-link">ppp.object</a></code> initially passed to the
  <code>pp</code> argument, containing the data that were smoothed.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Davies &amp; Baddeley (2018) investigated computational aspects of Abramson's
(1982) adaptive kernel smoother for spatial (2D) data. This function is the
implementation of the 3D convolution via a fast-Fourier transform (FFT)
which allows simultaneous calculation of an adaptive kernel estimate at
multiple global bandwidth scales.</p>
<p>These `multiple global bandwidth scales' are computed with respect to
rescaling a reference value of the global bandwidth passed to the <code>h0</code>
argument. This rescaling is defined by the range provided to the argument
<code>h0fac</code>. For example, by default, the function will compute the
adaptive kernel estimate for a range of global bandwidths between
0.25*<code>h0</code> and 1.5*<code>h0</code>. The exact numeric limits are subject to
discretisation, and so the returned valid range of global bandwidths will
differ slightly. The exact resulting range following function execution is
returned as the <code>h0range</code> element of the result, see `Value' below.</p>
<p>The distinct values of global bandwidth used (which define the
aforementioned <code>h0range</code>) and hence the total number of pixel
<code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a>ages</code> returned depend on both the width of the span
<code>h0fac</code> and the discretisation applied to the bandwidth axis through
<code>dimz</code>. Increasing this z-resolution will provide more pixel images and
hence greater numeric precision, but increases computational cost. The
returned pixel <code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a>ages</code> that represent the multiscale
estimates are stored in a named list (see `Value'), whose names reflect the
corresponding distinct global bandwidth. See `Examples' for the easy way to
extract these distinct global bandwidths.</p>
<p>The user can request an interpolated density/intensity estimate for any
global bandwidth value within <code>h0range</code> by using the
<code><a href="multiscale.slice.html">multiscale.slice</a></code> function, which returns an object of class
<code><a href="bivariate.density.html">bivden</a></code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Abramson, I. (1982). On bandwidth variation in kernel estimates
--- a square root law, <em>Annals of Statistics</em>, <b>10</b>(4),
1217-1223.</p>
<p>Davies, T.M. and Baddeley A. (2018), Fast computation of
spatially adaptive kernel estimates, <em>Statistics and Computing</em>, <b>28</b>(4), 937-956.</p>
<p>Silverman, B.W. (1986), <em>Density Estimation for Statistics and Data Analysis</em>,
Chapman &amp; Hall, New York.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="bivariate.density.html">bivariate.density</a></code>, <code><a href="multiscale.slice.html">multiscale.slice</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>T.M. Davies and A. Baddeley</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">chorley</span><span class="op">)</span> <span class="co"># Chorley-Ribble data (package 'spatstat')</span></span></span>
<span class="r-in"><span><span class="va">ch.multi</span> <span class="op">&lt;-</span> <span class="fu">multiscale.density</span><span class="op">(</span><span class="va">chorley</span>,h0<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discretising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Forming kernel...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Taking FFT of kernel...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discretising point locations...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FFT of point locations...Inverse FFT of smoothed point locations...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [ Point convolution: maximum imaginary part= 2.6e-13 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FFT of window...Inverse FFT of smoothed window...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [ Window convolution: maximum imaginary part= 8.12e-17 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Looking up edge correction weights...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2  3  4  5  6  7  8  9  10  11  12  13  14  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ch.multi</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multiscale.density-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-6.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-7.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-8.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-9.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-11.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-12.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-13.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ch.pilot</span> <span class="op">&lt;-</span> <span class="fu"><a href="bivariate.density.html">bivariate.density</a></span><span class="op">(</span><span class="va">chorley</span>,h0<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span> <span class="co"># with pre-defined pilot density</span></span></span>
<span class="r-in"><span><span class="va">ch.multi2</span> <span class="op">&lt;-</span> <span class="fu">multiscale.density</span><span class="op">(</span><span class="va">chorley</span>,h0<span class="op">=</span><span class="fl">1</span>,pilot.density<span class="op">=</span><span class="va">ch.pilot</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discretising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Forming kernel...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Taking FFT of kernel...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discretising point locations...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FFT of point locations...Inverse FFT of smoothed point locations...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [ Point convolution: maximum imaginary part= 3.35e-13 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FFT of window...Inverse FFT of smoothed window...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [ Window convolution: maximum imaginary part= 9.42e-17 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Looking up edge correction weights...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2  3  4  5  6  7  8  9  10  11  12  13  14  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ch.multi2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multiscale.density-15.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-16.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-17.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-18.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-19.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-20.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-21.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-22.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-23.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-24.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-25.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-26.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-27.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-28.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># widen h0 scale, increase z-axis resolution</span></span></span>
<span class="r-in"><span><span class="va">pbc.multi</span> <span class="op">&lt;-</span> <span class="fu">multiscale.density</span><span class="op">(</span><span class="va">pbc</span>,h0<span class="op">=</span><span class="fl">2</span>,hp<span class="op">=</span><span class="fl">1</span>,h0fac<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">2.5</span><span class="op">)</span>,dimz<span class="op">=</span><span class="fl">128</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discretising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Forming kernel...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Taking FFT of kernel...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discretising point locations...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FFT of point locations...Inverse FFT of smoothed point locations...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [ Point convolution: maximum imaginary part= 1.14e-12 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FFT of window...Inverse FFT of smoothed window...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [ Window convolution: maximum imaginary part= 7.13e-14 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Looking up edge correction weights...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pbc.multi</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multiscale.density-29.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-30.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-31.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-32.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-33.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-34.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-35.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-36.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-37.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-38.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-39.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-40.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-41.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-42.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-43.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-44.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-45.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-46.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-47.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-48.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-49.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-50.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-51.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-52.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-53.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-54.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-55.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-56.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-57.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-58.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="multiscale.density-59.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tilman M. Davies, Jonathan C. Marshall.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

