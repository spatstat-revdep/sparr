<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Bootstrap bandwidth for a spatial kernel density estimate — BOOT.density • sparr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap bandwidth for a spatial kernel density estimate — BOOT.density"><meta property="og:description" content="Isotropic fixed or global (for adaptive) bandwidth selection for a standalone 2D density based on bootstrap estimation of the MISE."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3-10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/fmd_animation/fmd_animation.html">Foot and Mouth disease animation</a>
    </li>
    <li>
      <a href="../articles/fmd_interactive/fmd_interactive.html">Foot and mouth disease interactive</a>
    </li>
    <li>
      <a href="../articles/pbc_interactive/pbc_interactive.html">Primary biliary cirrhosis interactive</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tilmandavies/sparr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrap bandwidth for a spatial kernel density estimate</h1>
    
    <div class="hidden name"><code>BOOT.density.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Isotropic fixed or global (for adaptive) bandwidth selection for a standalone 2D density based on bootstrap estimation of the MISE.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">BOOT.density</span><span class="op">(</span><span class="va">pp</span>, hlim <span class="op">=</span> <span class="cn">NULL</span>, eta <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixed"</span>, <span class="st">"adaptive"</span><span class="op">)</span>,</span>
<span>  hp <span class="op">=</span> <span class="cn">NULL</span>, edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uniform"</span>, <span class="st">"none"</span><span class="op">)</span>, ref.density <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">64</span>, rmdiag <span class="op">=</span> <span class="cn">TRUE</span>, sim.adapt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">50</span>, B <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  dimz <span class="op">=</span> <span class="fl">64</span>, objective <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, parallelise <span class="op">=</span> <span class="cn">NA</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pp</dt>
<dd><p>An object of class <code><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html" class="external-link">ppp</a></code> giving the observed 2D data to be smoothed.</p></dd>

  <dt>hlim</dt>
<dd><p>An optional vector of length 2 giving the limits of the optimisation routine with respect to the bandwidth. If <code>NULL</code>, the function attempts to choose this automatically.</p></dd>

  <dt>eta</dt>
<dd><p>Fixed scalar bandwidth to use for the reference density estimate; if <code>NULL</code> it is calculated as the oversmoothing bandwidth of <code>pp</code> using <code><a href="OS.html">OS</a></code>. Ignored if <code>ref.density</code> is supplied. See `Details'.</p></dd>

  <dt>type</dt>
<dd><p>A character string indicating selection type. Either <code>"fixed"</code> (default) for selection of a constant bandwidth for the fixed-bandwidth estimator based on theory extended from results in Taylor (1989); or <code>"adaptive"</code> for selection of the global bandwidth for an adaptive kernel density. See `Details'.</p></dd>

  <dt>hp</dt>
<dd><p>Pilot bandwidth used for adaptive estimates in the bootstrap; see the argument of the same tag in <code><a href="bivariate.density.html">bivariate.density</a></code>. Ignored when <code>type = "fixed"</code> or when <code>ref.density</code> is supplied.</p></dd>

  <dt>edge</dt>
<dd><p>Character string dictating edge correction for the bootstrapped estimates. <code>"uniform"</code> (default) corrects based on evaluation grid coordinate. Setting <code>edge="none"</code> requests no edge correction.</p></dd>

  <dt>ref.density</dt>
<dd><p>Optional. An object of class <code><a href="bivariate.density.html">bivden</a></code> giving the reference density from which data will be generated. Based on theory, this must be a fixed-bandwidth estimate if <code>type = "fixed"</code>; see `Details'. Must be edge-corrected if <code>edge = "uniform"</code>.</p></dd>

  <dt>resolution</dt>
<dd><p>Spatial grid size; the optimisation will be based on a [<code>resolution</code> \(\times\) <code>resolution</code>] density estimate.</p></dd>

  <dt>rmdiag</dt>
<dd><p>Logical control value for removal of mirrored evaluation points as suggested by Taylor (1989) in the theoretical expression of the fixed-bandwidth MISE estimate. See `Details'. Ignored when <code>type = "adaptive"</code></p></dd>

  <dt>sim.adapt</dt>
<dd><p>List of control values for bootstrap simulation in the adaptive case; see `Details'. Ignored when <code>type = "fixed"</code>.</p></dd>

  <dt>parallelise</dt>
<dd><p>Optional numeric argument to reduce computation time by invoking parallel processing, by giving the number of CPU cores to use in either evaluation (fixed) or in the actual bootstrap replicate generation (adaptive). Experimental. Test your system first using <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code> to identify the number of cores available to you.</p></dd>

  <dt>verbose</dt>
<dd><p>Logical value indicating whether to print function progress during execution.</p></dd>

  <dt>...</dt>
<dd><p>Optional arguments controlling scaling to be passed to <code><a href="multiscale.density.html">multiscale.density</a></code> for the adaptive bootstrap; ignored when <code>type = "fixed"</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>For a 2D kernel density estimate \(\hat{f}\) defined on \(W \in R^2\), the mean integrated squared error (MISE) is given by \(E[\int_W (\hat{f}(x) - f(x))^2 dx]\), where \(f\) is the corresponding true density. Given an observed data set \(X\) (argument <code>pp</code>) of \(n\) observations, this function finds the bandwidth \(h\) that minimises
$$E^*[\int_W (\hat{f}^*(x) - \hat{f}(x))^2 dx],$$
where \(\hat{f}(x)\) is a density estimate of \(X\) constructed with `reference' bandwidth \(\eta\) (argument <code>eta</code> or <code>ref.density</code>), and \(\hat{f}^*(x)\) is a density estimate using bandwidth \(h\) of \(n\) observations \(X^*\) generated from \(\hat{f}(x)\). The notation \(E^*\) denotes expectation with respect to the distribution of the \(X^*\).</p>
<dl><dt><b>Fixed</b></dt>
<dd><p>When <code>type = "fixed"</code>, the function assumes you want to select a constant bandwidth for use with the fixed-bandwith density estimator. This implementation is based on extending the remarkable results of Taylor (1989) (see also Sain et al., 1994), who demonstrates that when the Gaussian kernel is being used, we can find the optimal \(h\) with respect to the aforementioned bootstrap-estimated MISE without any actual resampling. This implementation extends these results to the bivariate setting, and allows for edge-correction of both the reference and bootstrap densities.</p><ul><li><p>Taylor (1989) does not distinguish between the reference bandwidth \(\eta\) and the target of optimisation, \(h\), thus allowing the reference bandwidth to vary alongside the target in the optimisation. This is not optimal, and this function always assumes a static reference bandwidth. Hall et al. (1992) indicate that a generous amount of smoothing is to be preferred in the reference density (hence the default <code>eta</code> set using <code><a href="OS.html">OS</a></code>).</p></li>
<li><p>If <code>ref.density</code> is supplied, it <b>must</b> be a fixed-bandwidth density estimate as an object of class <code><a href="bivariate.density.html">bivden</a></code> for validity of the theory. Edge-correction must be present if <code>edge = "uniform"</code>; and it must be evaluated on the same spatial domain as dictated by <code>Window(pp)</code> and <code>resolution</code>. If unsupplied, the function internally computes an appropriate fixed-bandwidth density estimate using <code>eta</code> as the reference bandwidth.</p></li>
<li><p>Finally, Taylor (1989) argues it is preferable to avoid summation at identical evaluation grid points in the expression for the optimal bandwidth, which is performed when <code>rmdiag = TRUE</code>. Setting <code>rmdiag = FALSE</code> disables this correction.</p></li>
</ul></dd>

<dt><b>Adaptive</b></dt>
<dd><p>When <code>type = "adaptive"</code>, the function assumes you want to select a global bandwidth (argument <code>h0</code> in <code><a href="bivariate.density.html">bivariate.density</a></code>) for use in 2D adaptive kernel density estimation.</p><ul><li><p>An expression similar to Taylor (1989) is not possible for the adaptive estimator. Thus, in the adaptive setting, the optimal bootstrap bandwidth is calculated by brute force as was performed in Davies and Baddeley (2018) by taking advantage of the multiscale estimation theory implemented in <code><a href="multiscale.density.html">multiscale.density</a></code>. The value that minimises an interpolating cubic spline of the estimated MISE on bandwidth is identified as the optimal global bandwidth.</p></li>
<li><p>The user can pass either a fixed or adaptive <code>bivden</code> object to <code>ref.density</code>. If this is the case, <code>hp</code> is ignored and the pilot bandwidth for each iteration of the bootstrap in estimation of the \(\hat{f}^*(x)\) uses <code>ref.density$hp</code> (if <code>ref.density</code> is adaptive) or <code>ref.density$h0</code> (if <code>ref.density</code> is fixed). When <code>ref.density</code> is unsupplied, the function uses a fixed-bandwidth kernel estimate with bandwidth <code>eta</code> as the reference density, and if additionally <code>hp</code> is unsupplied, the same value <code>eta</code> is used for the constant pilot bandwidth.</p></li>
<li><p>Control over the bootstrap is achieved with four optional named arguments passed as a list to <code>sim.adapt</code>. <code>N</code> controls the number of bootstrap iterates per bandwidth; <code>B</code> controls the resolution of the sequence of bandwidths trialled (i.e. between <code>hlim[1]</code> and <code>hlim[2]</code>); <code>dimz</code> specifies the resolution of the bandwidth axis in the trivariate convolution evaluated by <code><a href="multiscale.density.html">multiscale.density</a></code>; and <code>objective</code> specifies whether to return the set of estimated MISEs for all bandwidths (nice to plot), or merely the optimal bandwidth (see `Value').</p></li>
<li><p>The <code>...</code> are intended for any relevant optional arguments to be passed to the internal call to <code><a href="multiscale.density.html">multiscale.density</a></code>, such as <code>gamma.scale</code> or <code>trim</code>.</p></li>
</ul></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The optimal fixed or global (for adaptive) scalar bandwidth. If <code>simargs$objective = TRUE</code> for the adaptive bootstrap, the return object is instead a \([\)<code>simargs$B</code></p>
<p></p>
<p>\(x 2]\) matrix, with the first column giving the trialled bandwidth and the second giving the corresponding value of the estimated bootstrap MISE.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Davies, T.M. and Baddeley A. (2018), Fast computation of spatially adaptive kernel estimates, <em>Statistics and Computing</em>, <b>28</b>(4), 937-956.<br><br>
Hall, P., Marron, J.S. and Park, B.U. (1992) Smoothed cross-validation, <em>Probability Theory and Related Fields</em>, <b>92</b>, 1-20.<br><br>
Sain, S.R., Baggerly, K.A. and Scott, D.W. (1994) Cross-validation of multivariate densities, <em>Journal of the American Statistical Association</em>, <b>89</b>, 807-817.<br><br>
Taylor, C.C. (1989) Bootstrap choice of the smoothing parameter in kernel density estimation, <em>Biometrika</em>, <b>76</b>, 705-712.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>T.M. Davies</p>
    </div>
    <div id="warning">
    <h2>Warning</h2>
    <p>Even with the implemented computational tricks, bootstrapping for bandwidth selection for spatial data is still computationally demanding, especially for adaptive kernel estimates. The user can reduce this time by keeping the evaluation grid at modest <code>resolution</code>s, and experimenting with parallelising the internal loops via <code>parallelise</code>. The `Examples' section offers some rough indications of evaluation times on this author's local machine.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="bivariate.density.html">bivariate.density</a></code>, <code><a href="OS.html">OS</a></code>, <code><a href="multiscale.density.html">multiscale.density</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fixed bandwidth selection ##</span></span></span>
<span class="r-in"><span><span class="fu">BOOT.density</span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span> <span class="co"># ~20 secs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Searching for optimal h in [0.0999999999999091, 15.2778333333333]...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 5.897416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 9.480417 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 3.683 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 2.314416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.468584 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.770519 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.821183 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.78084 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.777511 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.777469 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.777428 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.777469 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.777469</span>
<span class="r-in"><span><span class="fu">BOOT.density</span><span class="op">(</span><span class="va">pbc</span>,eta<span class="op">=</span><span class="fu"><a href="OS.html">OS</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="co"># halve default reference bandwidth</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Searching for optimal h in [0.0999999999999091, 15.2778333333333]...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 5.897416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 9.480417 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 3.683 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 2.314416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.468584 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 0.9458317 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.308393 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.265221 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.219808 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.231512 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.232196 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.232007 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.232047 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.231966 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.232007 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.232007</span>
<span class="r-in"><span><span class="fu">BOOT.density</span><span class="op">(</span><span class="va">pbc</span>,eta<span class="op">=</span><span class="fu"><a href="OS.html">OS</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span> <span class="co"># double default reference bandwidth</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Searching for optimal h in [0.0999999999999091, 15.2778333333333]...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 5.897416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 9.480417 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 3.683 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 2.314416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.468584 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 2.190551 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 2.02887 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.81486 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.94454 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.940646 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.935422 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.93594 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.93598 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.935899 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.93594 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.93594</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># supplying pre-defined reference density as fixed-bandwidth 'bivden' object</span></span></span>
<span class="r-in"><span><span class="va">pbcfix</span> <span class="op">&lt;-</span> <span class="fu"><a href="bivariate.density.html">bivariate.density</a></span><span class="op">(</span><span class="va">pbc</span>,h0<span class="op">=</span><span class="fl">2.5</span>,resolution<span class="op">=</span><span class="fl">64</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">hfix</span> <span class="op">&lt;-</span> <span class="fu">BOOT.density</span><span class="op">(</span><span class="va">pbc</span>,ref.density<span class="op">=</span><span class="va">pbcfix</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Searching for optimal h in [0.0999999999999091, 15.2778333333333]...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 5.897416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 9.480417 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 3.683 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 2.314416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.468584 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.505088 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.686309 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.926225 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.638642 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.643595 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.642006 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.641965 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.641925 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h: 1.641965 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  14.876   2.995  17.886 </span>
<span class="r-in"><span><span class="va">hfix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.641965</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Global (for adaptive) bandwidth selection ##</span></span></span>
<span class="r-in"><span><span class="co"># ~200 secs next line; use 'parallelise' for speedup</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">hada</span> <span class="op">&lt;-</span> <span class="fu">BOOT.density</span><span class="op">(</span><span class="va">pbc</span>,type<span class="op">=</span><span class="st">"adaptive"</span><span class="op">)</span><span class="op">)</span> <span class="co"># minimal usage for adaptive bootstrap</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Searching for optimal h0 in [0.0999999999999091, 15.2778333333333]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 139.706   9.993 149.288 </span>
<span class="r-in"><span><span class="va">hada</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.728287</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ~80 secs next line. Set custom h limits; increase reference bandwidth;</span></span></span>
<span class="r-in"><span><span class="co">#    set custom pilot bandwidth; return objective function; use 'parallelise' for speedup</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">hada</span> <span class="op">&lt;-</span> <span class="fu">BOOT.density</span><span class="op">(</span><span class="va">pbc</span>,hlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">8</span><span class="op">)</span>,eta<span class="op">=</span><span class="fl">3.5</span>,type<span class="op">=</span><span class="st">"adaptive"</span>,</span></span>
<span class="r-in"><span>                                 hp<span class="op">=</span><span class="fu"><a href="OS.html">OS</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>,sim.adapt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>objective<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Searching for optimal h0 in [0.9, 8]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131.719   8.376 139.721 </span>
<span class="r-in"><span><span class="va">hada</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">hada</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   h0seq </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.22958 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hada</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">hada</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">hada</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="BOOT.density-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tilman M. Davies, Jonathan C. Marshall.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

