<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Tolerance by p-value surfaces — tolerance • sparr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Tolerance by p-value surfaces — tolerance"><meta property="og:description" content="Calculates a p-value surface based on asymptotic theory or
Monte-Carlo (MC) permutations describing the extremity of risk given a fixed
or adaptive kernel-smoothed density-ratio, allowing the drawing of
tolerance contours."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/fmd_animation/fmd_animation.html">Foot and Mouth disease animation</a>
    </li>
    <li>
      <a href="../articles/fmd_interactive/fmd_interactive.html">Foot and mouth disease interactive</a>
    </li>
    <li>
      <a href="../articles/pbc_interactive/pbc_interactive.html">Primary biliary cirrhosis interactive</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tilmandavies/sparr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tolerance by <em>p</em>-value surfaces</h1>
    <small class="dont-index">Source: <a href="https://github.com/tilmandavies/sparr/blob/HEAD/R/tolerance.R" class="external-link"><code>R/tolerance.R</code></a></small>
    <div class="hidden name"><code>tolerance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates a <em>p</em>-value surface based on asymptotic theory or
Monte-Carlo (MC) permutations describing the extremity of risk given a fixed
or adaptive kernel-smoothed density-ratio, allowing the drawing of
<em>tolerance contours</em>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tolerance</span><span class="op">(</span></span>
<span>  <span class="va">rs</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ASY"</span>, <span class="st">"MC"</span><span class="op">)</span>,</span>
<span>  ref.density <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  ITER <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  parallelise <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rs</dt>
<dd><p>An object of class <code><a href="risk.html">rrs</a></code> giving the estimated relative
risk function for which to calculate the <em>p</em>-value surface.</p></dd>


<dt>method</dt>
<dd><p>A character string specifying the method of calculation.
<code>"ASY"</code> (default) instructs the function to compute the <em>p</em>-values
using asymptotic theory. <code>"MC"</code> computes the values by random
permutations of the data. See `Details'.</p></dd>


<dt>ref.density</dt>
<dd><p>Required if <code>rs</code> is based on fixed-bandwidth
estimates of the case and control densities and <code>method = "ASY"</code>.
Either a pixel <code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a></code>age or an object of class
<code><a href="bivariate.density.html">bivden</a></code> giving the reference density to use in asymptotic
formulae. May be unnormalised. Ignored if <code>rs</code> is based on adaptive
kernel estimates or if <code>method = "MC"</code>.</p></dd>


<dt>beta</dt>
<dd><p>A numeric value \(0 &lt;\) <code>beta</code> \(&lt; 1\) giving the
fineness of the adaptive bandwidth partitioning to use for calculation of
the required quantities for asymptotic adaptive <em>p</em>-value surfaces.
Smaller values provide more accurate bandwidth bins at the cost of
additional computing time, see Davies and Baddeley (2018); the default is
sensible in most cases. Ignored if <code>rs</code> is based on fixed-bandwidth
kernel estimates.</p></dd>


<dt>ITER</dt>
<dd><p>Number of iterations for the Monte-Carlo permutations. Ignored
if <code>method = "ASY"</code>.</p></dd>


<dt>parallelise</dt>
<dd><p>Numeric argument to invoke parallel processing, giving
the number of CPU cores to use when <code>method = "MC"</code>. Experimental. Test
your system first using <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code> to identify the
number of cores available to you.</p></dd>


<dt>verbose</dt>
<dd><p>Logical value indicating whether to print function progress
during execution.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to <code><a href="risk.html">risk</a></code> when
<code>method = "MC"</code>. While most information needed for the MC repetitions
is implicitly gleaned from the object passed to <code>rs</code>, this ellipsis is
typically used to set the appropriate <code>epsilon</code> and
<code>pilot.symmetry</code> values for the internal calls to <code><a href="risk.html">risk</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A pixel <code><a href="https://rdrr.io/pkg/spatstat.geom/man/im.html" class="external-link">im</a></code>age of the estimated
<em>p</em>-value surface.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function implements developments in Hazelton and Davies (2009) (fixed)
and Davies and Hazelton (2010) (adaptive) to compute pointwise
<em>p</em>-value surfaces based on asymptotic theory of kernel-smoothed
relative risk surfaces. Alternatively, the user may elect to calculate the
<em>p</em>-value surfaces using Monte-Carlo methods (see Kelsall and Diggle,
1995). Superimposition upon a plot of the risk surface contours of these
<em>p</em>-values at given significance levels (i.e. ``tolerance contours'')
can be an informative way of exploring the statistical significance of the
extremity of risk across the defined study region.</p>
<p>Implementation of the Monte-Carlo method simply involves random allocation of case/control marks and
re-estimation of the risk surface <code>ITER</code> times, against which the
original estimate is compared.  While not dependent on asymptotic theory, it is
computationally expensive, and it has been suggested that it might have some
undesirable practical consequences in certain settings (Hazelton and Davies,
2009). When performing the MC simulations, the same global (and pilot, if
necessary) bandwidths and edge-correction regimens are employed as were used
in the initial density estimates of the observed data. With regard to
arguments to be passed to internal calls of <code><a href="risk.html">risk</a></code>, the user
should take care to use <code>...</code> to set the <code>epsilon</code> value to match
that which was used in creation of the object passed to <code>rs</code> (if this
was set to a non-default value). Furthermore, if performing MC simulations
for the adaptive relative risk function, the function borrows the value of
the <code>beta</code> argument to speed things up via partitioning, and the user
should additionally access <code>...</code> to set the same <code>pilot.symmetry</code>
value as was used for creation of the object passed to <code>rs</code>, in the
same way as for any non-default use of <code>epsilon</code>. This will ensure the
simulations are all performed under the same conditions as were used to estimate the original risk
function.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The returned <em>p</em>-values are geared so that ``smallness''
corresponds to statistical significance of elevated risk, that is, an
upper-tailed test. The complement of the <em>p</em>-values will yeild
significance of reduced risk; a lower-tailed test. When using
<code><a href="tol.contour.html">tol.contour</a></code>, the user can control what type of contours to
display.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Davies, T.M. and Baddeley A. (2018), Fast computation of
spatially adaptive kernel estimates, <em>Statistics and Computing</em>, <b>28</b>(4), 937-956.</p>
<p>Davies, T.M. and Hazelton, M.L. (2010), Adaptive kernel estimation of spatial relative
risk, <em>Statistics in Medicine</em>, <b>29</b>(23) 2423-2437.</p>
<p>Davies, T.M., Jones, K. and Hazelton, M.L. (2016), Symmetric adaptive smoothing regimens for estimation of the spatial
relative risk function, <em>Computational Statistics &amp; Data Analysis</em>,
<b>101</b>, 12-28.</p>
<p>Hazelton, M.L. and Davies, T.M. (2009), Inference based on kernel estimates
of the relative risk function in geographical epidemiology,
<em>Biometrical Journal</em>, <b>51</b>(1), 98-109.</p>
<p>Kelsall, J.E. and Diggle, P.J. (1995), Kernel estimation of relative risk, <em>Bernoulli</em>,
<b>1</b>, 3-16.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>T. M. Davies</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">h0</span> <span class="op">&lt;-</span> <span class="fu"><a href="LSCV.risk.html">LSCV.risk</a></span><span class="op">(</span><span class="va">pbc</span>,method<span class="op">=</span><span class="st">"hazelton"</span><span class="op">)</span>;<span class="va">h0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Searching for optimal Hazelton h in [0.1,15.278]...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.04405</span>
<span class="r-in"><span><span class="va">pbccas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pbccon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ASY</span></span></span>
<span class="r-in"><span><span class="va">riskfix</span> <span class="op">&lt;-</span> <span class="fu"><a href="risk.html">risk</a></span><span class="op">(</span><span class="va">pbc</span>,h0<span class="op">=</span><span class="va">h0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating case and control densities...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span><span class="va">fixtol1</span> <span class="op">&lt;-</span> <span class="fu">tolerance</span><span class="op">(</span><span class="va">riskfix</span>,ref.density<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">pbc</span>,<span class="fu"><a href="OS.html">OS</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising window...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performing kernel*window convolution(s)...Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">riskada</span> <span class="op">&lt;-</span> <span class="fu"><a href="risk.html">risk</a></span><span class="op">(</span><span class="va">pbc</span>,h0<span class="op">=</span><span class="va">h0</span>,adapt<span class="op">=</span><span class="cn">TRUE</span>,hp<span class="op">=</span><span class="fu"><a href="NS.html">NS</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span>,pilot.symmetry<span class="op">=</span><span class="st">"pooled"</span>,davies.baddeley<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating case density...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating control density...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span><span class="va">adatol1</span> <span class="op">&lt;-</span> <span class="fu">tolerance</span><span class="op">(</span><span class="va">riskada</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising window...Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convolving bandwidth-categorised kernels with window:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  --pass 1...Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">riskfix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tol.contour.html">tol.contour</a></span><span class="op">(</span><span class="va">fixtol1</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">riskada</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tol.contour.html">tol.contour</a></span><span class="op">(</span><span class="va">adatol1</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tolerance-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># MC</span></span></span>
<span class="r-in"><span><span class="va">fixtol2</span> <span class="op">&lt;-</span> <span class="fu">tolerance</span><span class="op">(</span><span class="va">riskfix</span>,method<span class="op">=</span><span class="st">"MC"</span>,ITER<span class="op">=</span><span class="fl">200</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">adatol2</span> <span class="op">&lt;-</span> <span class="fu">tolerance</span><span class="op">(</span><span class="va">riskada</span>,method<span class="op">=</span><span class="st">"MC"</span>,ITER<span class="op">=</span><span class="fl">200</span>,parallelise<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># ~90secs with parallelisation</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running MC iterations on 2 / 16 cores...Done.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">riskfix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tol.contour.html">tol.contour</a></span><span class="op">(</span><span class="va">fixtol2</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">riskada</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tol.contour.html">tol.contour</a></span><span class="op">(</span><span class="va">adatol2</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tolerance-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tilman M. Davies, Jonathan C. Marshall.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

