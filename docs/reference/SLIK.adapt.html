<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simultaneous global/pilot likelihood bandwidth selection — SLIK.adapt • sparr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simultaneous global/pilot likelihood bandwidth selection — SLIK.adapt" />
<meta property="og:description" content="Isotropic global and pilot bandwidth selection for adaptive density/intensity
based on likelihood cross-validation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2-15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fmd_animation/fmd_animation.html">Foot and Mouth disease animation</a>
    </li>
    <li>
      <a href="../articles/fmd_interactive/fmd_interactive.html">Foot and mouth disease interactive</a>
    </li>
    <li>
      <a href="../articles/pbc_interactive/pbc_interactive.html">Primary biliary cirrhosis interactive</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tilmandavies/sparr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simultaneous global/pilot likelihood bandwidth selection</h1>
    <small class="dont-index">Source: <a href='https://github.com/tilmandavies/sparr/blob/master/R/SLIK.adapt.R'><code>R/SLIK.adapt.R</code></a></small>
    <div class="hidden name"><code>SLIK.adapt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Isotropic global and pilot bandwidth selection for adaptive density/intensity
based on likelihood cross-validation.</p>
    </div>

    <pre class="usage"><span class='fu'>SLIK.adapt</span><span class='op'>(</span>
  <span class='va'>pp</span>,
  hold <span class='op'>=</span> <span class='cn'>TRUE</span>,
  start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='OS.html'>OS</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>,
  hlim <span class='op'>=</span> <span class='cn'>NULL</span>,
  edge <span class='op'>=</span> <span class='cn'>TRUE</span>,
  zero.action <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,
  optim.control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  parallelise <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pp</th>
      <td><p>An object of class <code><a href='https://rdrr.io/pkg/spatstat.geom/man/ppp.html'>ppp</a></code> giving the observed
2D data to be smoothed.</p></td>
    </tr>
    <tr>
      <th>hold</th>
      <td><p>Logical value indicating whether to hold the global and pilot bandwidths equal throughout the
optimisation; defaults to <code>TRUE</code>. See `Details'.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>A positively-valued numeric vector of length 2 giving the starting values to be used for the global/pilot
optimisation routine when <code>hold = FALSE</code>. Defaults to the oversmoothing bandwidth (<code><a href='OS.html'>OS</a></code>) for both values;
ignored when <code>hold = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>hlim</th>
      <td><p>An optional vector of length 2 giving the limits of the
optimisation routine with respect to the bandwidth when <code>hold = TRUE</code>. If unspecified, the
function attempts to choose this automatically. Ignored when <code>hold = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>edge</th>
      <td><p>Logical value indicating whether to edge-correct the density
estimates used.</p></td>
    </tr>
    <tr>
      <th>zero.action</th>
      <td><p>A numeric vector of length 2, each value being either <code>-1</code>, <code>0</code> (default), <code>1</code> or <code>2</code> controlling how the function should behave in response to numerical errors at very small bandwidths, when such a bandwidth results in one or more zero or negative density values during the leave-one-out computations. See `Details'.</p></td>
    </tr>
    <tr>
      <th>optim.control</th>
      <td><p>An optional list to be passed to the <code>control</code> argument of <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> for further control over the numeric optimisation when <code>hold = FALSE</code>. See the documentation for <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> for further details.</p></td>
    </tr>
    <tr>
      <th>parallelise</th>
      <td><p>Numeric argument to invoke parallel processing in the brute force leave-one-out calculations, giving
the number of CPU cores to use. Experimental. Test
your system first using <code><a href='https://rdrr.io/r/parallel/detectCores.html'>parallel::detectCores()</a></code> to identify the
number of cores available to you. If <code>NA</code> (default), no parallelisation performed and a single loop is used.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical value indicating whether to provide function progress
commentary.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments controlling density estimation for the internal calculations. Relevant arguments are <code>resolution</code>, <code>gamma.scale</code>, and <code>trim</code>. If unsupplied these default to <code>64</code>, <code>"geometric"</code>, and <code>5</code> respectively; see <code><a href='bivariate.density.html'>bivariate.density</a></code> for a further explanation of these arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A numeric vector of length 2 giving the likelihood-maximised global and pilot bandwidths.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is a generalisation of <code><a href='LIK.density.html'>LIK.density</a></code>, and is used in attempts to simultaneously choose
an optimal global and pilot bandwidth for adaptive kernel density estimates. Where <code><a href='LIK.density.html'>LIK.density</a></code> for adaptive
estimates assumes the pilot density is held constant (and is not subject to the leave-one-out operations), this function
allows the pilot bandwidth to vary alongside the global.</p>
<p>Thus, in contrast to <code><a href='LIK.density.html'>LIK.density</a></code> the internal leave-one-out operations now also affect the
pilot estimation stage. Hence, the set of variable bandwidths changes as each point is left out. In turn, this means the leave-one-out operations must
be computed by brute force, and this is computationally expensive.</p>
<p>Identifiability problems can sometimes arise when the global and pilot bandwidths are allowed to `float freely' in the bivariate optimisation routine, which is the default
behaviour of the function (with <code>hold = FALSE</code>). This can be curbed by setting <code>hold = TRUE</code>, which forces both the global and pilot
to be held at the same value during optimisation. Doing this also has the beneficial side effect of turning the problem into one of univariate optimisation, thereby reducing total computational cost. Current work (Davies &amp; Lawson, 2018) provides some empirical evidence that this strategy performs quite well in practice.</p>
<p>Like <code><a href='LIK.density.html'>LSCV.density</a></code> and <code><a href='LIK.density.html'>LIK.density</a></code>, the argument <code>zero.action</code> can be used to control the level of severity in response to small bandwidths that result (due to numerical error) in at least one density value being zero or less. 
When this argument is passed a vector of length 2, the first entry corresponds to the global bandwidth (and hence refers to checks of the final adaptive density estimate and its leave-one-out values) and the second to the pilot bandwidth (and hence checks the fixed-bandwidth pilot density and its leave-one-out values).
Alternatively a single value may be supplied, which will be taken to be the same for both global and pilot.
See the help page for <code><a href='LIK.density.html'>LIK.density</a></code> for an explanation of the four allowable values (<code>-1</code>, <code>0</code>, <code>1</code>, <code>2</code>) for each component of this argument.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>While theoretically valid, this is a largely experimental function. There is presently little in the literature to suggest how well this
type of simultaneous global/pilot bandwidth selection might perform in practice. Current research efforts (Davies &amp; Lawson, 2018)
seek in part to address these questions.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Davies, T.M. and Lawson, A.B. (2018), An evaluation of likelihood-based bandwidth selectors for spatial and spatiotemporal kernel estimates, <em>Submitted for publication</em>.</p>
<p>Silverman, B.W. (1986), <em>Density Estimation for Statistics
and Data Analysis</em>, Chapman &amp; Hall, New York.</p>
<p>Wand, M.P. and Jones,
C.M., 1995. <em>Kernel Smoothing</em>, Chapman &amp; Hall, London.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Functions for bandwidth selection in package
  <code>spatstat</code>: <code><a href='https://rdrr.io/pkg/spatstat.core/man/bw.diggle.html'>bw.diggle</a></code>;
  <code><a href='https://rdrr.io/pkg/spatstat.core/man/bw.ppl.html'>bw.ppl</a></code>; <code><a href='https://rdrr.io/pkg/spatstat.core/man/bw.scott.html'>bw.scott</a></code>;
  <code><a href='https://rdrr.io/pkg/spatstat.core/man/bw.frac.html'>bw.frac</a></code>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>T. M. Davies</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

<span class='co'># \donttest{</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pbc</span><span class='op'>)</span>
<span class='va'>pbccas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>pbc</span><span class='op'>)</span><span class='op'>$</span><span class='va'>case</span>

<span class='fu'>SLIK.adapt</span><span class='op'>(</span><span class='va'>pbccas</span><span class='op'>)</span>
</div><div class='output co'>#&gt; h0: 5.897416; hp: 5.897416
#&gt; h0: 9.480417; hp: 9.480417
#&gt; h0: 3.683; hp: 3.683
#&gt; h0: 2.314416; hp: 2.314416
#&gt; h0: 1.468584; hp: 1.468584
#&gt; h0: 2.837169; hp: 2.837169
#&gt; h0: 1.991337; hp: 1.991337
#&gt; h0: 1.791663; hp: 1.791663
#&gt; h0: 2.114742; hp: 2.114742
#&gt; h0: 1.915069; hp: 1.915069
#&gt; h0: 2.038474; hp: 2.038474
#&gt; h0: 1.962205; hp: 1.962205
#&gt; h0: 1.944201; hp: 1.944201
#&gt; h0: 1.933073; hp: 1.933073
#&gt; h0: 1.926196; hp: 1.926196
#&gt; h0: 1.937323; hp: 1.937323
#&gt; h0: 1.930446; hp: 1.930446
#&gt; h0: 1.928823; hp: 1.928823
#&gt; h0: 1.93145; hp: 1.93145
#&gt; h0: 1.929826; hp: 1.929826
#&gt; h0: 1.929443; hp: 1.929443
#&gt; h0: 1.929206; hp: 1.929206
#&gt; h0: 1.929589; hp: 1.929589
#&gt; h0: 1.929352; hp: 1.929352
#&gt; h0: 1.929296; hp: 1.929296
#&gt; h0: 1.929256; hp: 1.929256
#&gt; h0: 1.929256; hp: 1.929256</div><div class='output co'>#&gt;       h0       hp 
#&gt; 1.929256 1.929256 </div><div class='input'><span class='fu'>SLIK.adapt</span><span class='op'>(</span><span class='va'>pbccas</span>,hold<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; h0: 5.897416; hp: 5.897416
#&gt; h0: 9.480417; hp: 9.480417
#&gt; h0: 3.683; hp: 3.683
#&gt; h0: 2.314416; hp: 2.314416
#&gt; h0: 1.468584; hp: 1.468584
#&gt; h0: 2.837169; hp: 2.837169
#&gt; h0: 1.991337; hp: 1.991337
#&gt; h0: 1.791663; hp: 1.791663
#&gt; h0: 2.114742; hp: 2.114742
#&gt; h0: 1.915069; hp: 1.915069
#&gt; h0: 2.038474; hp: 2.038474
#&gt; h0: 1.962205; hp: 1.962205
#&gt; h0: 1.944201; hp: 1.944201
#&gt; h0: 1.933073; hp: 1.933073
#&gt; h0: 1.926196; hp: 1.926196
#&gt; h0: 1.937323; hp: 1.937323
#&gt; h0: 1.930446; hp: 1.930446
#&gt; h0: 1.928823; hp: 1.928823
#&gt; h0: 1.93145; hp: 1.93145
#&gt; h0: 1.929826; hp: 1.929826
#&gt; h0: 1.929443; hp: 1.929443
#&gt; h0: 1.929206; hp: 1.929206
#&gt; h0: 1.929589; hp: 1.929589
#&gt; h0: 1.929352; hp: 1.929352
#&gt; h0: 1.929296; hp: 1.929296
#&gt; h0: 1.929256; hp: 1.929256
#&gt; h0: 1.929256; hp: 1.929256</div><div class='output co'>#&gt;       h0       hp 
#&gt; 1.929256 1.929256 </div><div class='input'>
<span class='co'># } </span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tilman M. Davies, Jonathan C. Marshall.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


