<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Random point generation inside polygon — rimpoly • sparr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Random point generation inside polygon — rimpoly" />
<meta property="og:description" content="Generates a random point pattern of \(n\) iid points with any specified distribution based on a pixel image and a corresponding polygonal window." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2-15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fmd_animation/fmd_animation.html">Foot and Mouth disease animation</a>
    </li>
    <li>
      <a href="../articles/fmd_interactive/fmd_interactive.html">Foot and mouth disease interactive</a>
    </li>
    <li>
      <a href="../articles/pbc_interactive/pbc_interactive.html">Primary biliary cirrhosis interactive</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tilmandavies/sparr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Random point generation inside polygon</h1>
    <small class="dont-index">Source: <a href='https://github.com/tilmandavies/sparr/blob/master/R/rimpoly.R'><code>R/rimpoly.R</code></a></small>
    <div class="hidden name"><code>rimpoly.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates a random point pattern of \(n\) iid points with any specified distribution based on a pixel image and a corresponding polygonal window.</p>
    </div>

    <pre class="usage"><span class='fu'>rimpoly</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>z</span>, w <span class='op'>=</span> <span class='cn'>NULL</span>, correction <span class='op'>=</span> <span class='fl'>1.1</span>, maxpass <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>Number of points to generate.</p></td>
    </tr>
    <tr>
      <th>z</th>
      <td><p>A pixel image of class <code><a href='https://rdrr.io/pkg/spatstat.geom/man/im.html'>im</a></code> defining the probability density of the points, possibly unnormalised.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>A polygonal window of class <code><a href='https://rdrr.io/pkg/spatstat.geom/man/owin.html'>owin</a></code>. See `Details'.</p></td>
    </tr>
    <tr>
      <th>correction</th>
      <td><p>An adjustment to the number of points generated at the initial pass of the internal loop in an effort to minimise the total number of passes required to reach \(n\) points. See `Details'.</p></td>
    </tr>
    <tr>
      <th>maxpass</th>
      <td><p>The maximum number of passes allowed before the function exits. If this is reached before \(n\) points are found that fall within <code>w</code>, a warning is issued.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code><a href='https://rdrr.io/pkg/spatstat.geom/man/ppp.html'>ppp</a></code> containing the <code>n</code> generated points, defined with the polygonal <code><a href='https://rdrr.io/pkg/spatstat.geom/man/owin.html'>owin</a></code>, <code>w</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is a deliberate variant of <code><a href='https://rdrr.io/pkg/spatstat.core/man/rpoint.html'>rpoint</a></code> (Baddeley et. al, 2015), to be accessed when the user desires 
a randomly generated point pattern based on a pixel image, but wants the window of the point pattern to be a corresponding irregular polygon, as opposed to a binary
image mask (which, when converted to a polygon directly, gives jagged edges based on the union of the pixels). When the user specifies their own polygonal window, a <code>while</code> loop is called and repeated as many
times as necessary (up to <code>maxpass</code> times) to find <code>n</code> points inside <code>w</code> (when <code>w = NULL</code>, then the aforementioned union of the pixels of <code>z</code>
is used, obtained via <code>as.polygonal(Window(z))</code>). The loop is necessary because the standard behaviour of <code><a href='https://rdrr.io/pkg/spatstat.core/man/rpoint.html'>rpoint</a></code> can (and often does)
yield points that sit in corners of pixels which lie outside the corresponding <code>w</code>.</p>
<p>The <code>correction</code> argument is used to determine how many points are generated initially,
which will be <code><a href='https://rdrr.io/r/base/Round.html'>ceiling(correction*n)</a></code>; to minimise the number of required passes over the loop this is by default set to give a number slightly higher than the requested <code>n</code>.</p>
<p>An error is thrown if <code>Window(z)</code> and <code>w</code> do not overlap.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Baddeley, A., Rubak, E. and Turner, R. (2015) <em>Spatial Point Patterns: Methodology and Applications with R</em>, Chapman and Hall/CRC Press, UK.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>T.M. Davies</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pbc</span><span class='op'>)</span>
<span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bivariate.density.html'>bivariate.density</a></span><span class='op'>(</span><span class='va'>pbc</span>,h0<span class='op'>=</span><span class='fl'>2.5</span>,res<span class='op'>=</span><span class='fl'>25</span><span class='op'>)</span>

<span class='co'># Direct use of 'rpoint':</span>
<span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'>rpoint</span><span class='op'>(</span><span class='fl'>500</span>,<span class='va'>Y</span><span class='op'>$</span><span class='va'>z</span><span class='op'>)</span>
<span class='fu'>npoints</span><span class='op'>(</span><span class='va'>A</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 500</div><div class='input'>
<span class='co'># Using 'rimpoly' without supplying polygon:</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'>rimpoly</span><span class='op'>(</span><span class='fl'>500</span>,<span class='va'>Y</span><span class='op'>$</span><span class='va'>z</span><span class='op'>)</span>
<span class='fu'>npoints</span><span class='op'>(</span><span class='va'>B</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 500</div><div class='input'>
<span class='co'># Using 'rimpoly' with the original pbc polygonal window:</span>
<span class='va'>C</span> <span class='op'>&lt;-</span> <span class='fu'>rimpoly</span><span class='op'>(</span><span class='fl'>500</span>,<span class='va'>Y</span><span class='op'>$</span><span class='va'>z</span>,<span class='fu'>Window</span><span class='op'>(</span><span class='va'>Y</span><span class='op'>$</span><span class='va'>pp</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>npoints</span><span class='op'>(</span><span class='va'>C</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 500</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>A</span>,main<span class='op'>=</span><span class='st'>"rpoint"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>B</span>,main<span class='op'>=</span><span class='st'>"rimpoly (no polygon supplied)"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>C</span>,main<span class='op'>=</span><span class='st'>"rimpoly (original polygon supplied)"</span><span class='op'>)</span>
</div><div class='img'><img src='rimpoly-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tilman M. Davies, Jonathan C. Marshall.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


